,......|............................,
:plus  |                            :
------+|                            :
:     |+-----+                      :
:     |      v                      :
:     +     *==============*        :
:     |     !case N of E, S!-+      :
:     |     *==============* |      :
: +---#--------#-------------+      :
: | +-#--------+                    :
: ++| |                             :
:  || |                             :
:  || |     *====================*  :
:  || +---->!send [(W, S),(W, E)]!-+:
:  ||       *====================* |:
:+-##----------#-------------------+:
:|+##----------+                    :
:+###--------+                      :
: |||        v                      :
: |||       *=============*         :
: |+#------>!send [(N, E)]!-+       :
: | |       *=============* |       :
: | |   +-------------------+       :
: | |   |                           :
: | +---#----+                      :
: |     |    v                      :
: |     |   *========*              :
: +-----#-->!use plus!-+            :
:       |   *========* |            :
:    +--#--------------+            :
:    |  |                           :
:    |  |                           :
:    |  |                           :
:    |  |   *=================*     :
:    +--#-->!send [(Inr W, E)]!-+   :
:       |   *=================* |   :
:       |+----------------------+   :
:       ||                          :
:       |+--------+++----------------
:       +------------+---------------
,...................................,

,......|............................,
:mult  |                            :
------+|                            :
:     ||                            :
:     ||                            :
:     ||    *====================*  :
:     +#--->!send [(W, E),(W, S)]!-+:
:      |    *====================* |:
:+-----#-------#-------------------+:
:|+----#-------+                    :
:||    +-----+                      :
:||          v                      :
:||         *==============*        :
:||         !case N of E, S!-+      :
:||         *==============* |      :
:|| +----------#-------------+      :
:||+#----------+                    :
:||+#--------+                      :
:|| |        v                      :
:|| |       *========*              :
:|+-#------>!use mult!-+            :
:|  |       *========* |            :
:|  |+-----------------+            :
:|  ||                              :
:|  ||                              :
:|  ||                              :
:|  ||      *==================*    :
:|  +#----->!send [(Inl (), E)]!-+  :
:|   |      *==================* |  :
:|   |  +------------------------+  :
:|   |  |                           :
:+---#--#----+                      :
:    |  |    v                      :
:    |  |   *========*              :
:    +--#-->!use plus!-+            :
:       |   *========* |            :
:       |+-------------+            :
:       ||                          :
:       |+---------------------------
:       +----------------------------
,...................................,

,...........................................................,
:main                                                       :
:                                                           :
:                                                           :
:                                                           :
:     *==================================================*  :
:     !send [(Inr Inr Inr Inl (), E),(Inr Inr Inl (), S)]!-+:
:     *==================================================* |:
:+-------#-------------------------------------------------+:
:|+------+                                                  :
:+#----+                                                    :
: |    v                                                    :
: |   *========*                                            :
: +-->!use mult!-+                                          :
:     *========* |                                          :
:  +-------------+                                          :
:  |                                                        :
:  +---------------------------------------------------------
,...........................................................,

